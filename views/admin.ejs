<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Mangia & Fuggi â€” Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
:root{--bg:#f6efe7;--panel:#fff;--ink:#2c2623;--muted:#7b6d66;--brand:#7a4a3b;--ring:#ead8cf;--ok:#1f8f4e;--warn:#b42318}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui}
.wrap{max-width:1200px;margin:0 auto;padding:16px}
h1{margin:0 0 10px;font-weight:800;letter-spacing:.3px}
.layout{display:grid;grid-template-columns:230px 1fr;gap:16px}
@media (max-width:900px){.layout{grid-template-columns:1fr}}
.side{background:var(--panel);border:1px solid var(--ring);border-radius:16px;padding:14px;height:fit-content;position:sticky;top:12px}
.nav .item{display:block;padding:10px 12px;border:1px solid #eee;border-radius:10px;margin-bottom:8px;color:inherit;text-decoration:none}
.nav .item.active{background:var(--brand);color:#fff;border-color:var(--brand)}
.card{background:var(--panel);border:1px solid var(--ring);border-radius:16px;padding:14px;margin-bottom:16px}
.row{display:flex;gap:10px;justify-content:space-between;align-items:center}
.muted{color:var(--muted)} .pill{background:#f3e7e2;color:var(--brand);border-radius:999px;padding:6px 10px;font-weight:700}
.btn{border:1px solid var(--ring);background:#fff;padding:8px 12px;border-radius:10px;cursor:pointer}
.btn.brand{background:var(--brand);border-color:var(--brand);color:#fff}
.btn.ok{background:#e8f6ee;border-color:#cde8d5;color:var(--ok)}
.btn.danger{background:#fdeaea;border-color:#f3caca;color:var(--warn)}
.input{border:1px solid var(--ring);border-radius:10px;padding:8px 10px;background:#fff}
.order{border:1px solid var(--ring);border-radius:14px;padding:12px;margin-bottom:12px;background:#fff}
.order .head{display:flex;gap:10px;justify-content:space-between;align-items:center;margin-bottom:8px}
.order .rows{margin-top:6px;border-top:1px dashed var(--ring);padding-top:6px}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media (max-width:900px){.grid2{grid-template-columns:1fr}}
.tbl table{width:100%;border-collapse:collapse;font-size:14px}
.tbl th,.tbl td{padding:8px;border-bottom:1px solid #eee;text-align:left}
.badge{display:inline-flex;align-items:center;gap:6px}
.bell{font-size:18px; cursor:pointer}
.bell.new{color:#d97706}
.clearx{margin-left:6px; cursor:pointer; color:#555}
.kg{display:flex;gap:8px;flex-wrap:wrap}
.kg .k{background:#fff;border:1px solid var(--ring);padding:8px 10px;border-radius:10px}
.tab.active{background:#f1d9d1}
</style>
</head>
<body>
<div class="wrap">
  <h1>Mangia & Fuggi â€” Dashboard</h1>
  <div class="layout">
    <!-- Sidebar -->
    <aside class="side">
      <div class="nav">
        <a href="#" class="item active" data-section="orders">ðŸ“‹ Ordini</a>
        <a href="#" class="item" data-section="stats">ðŸ“Š Statistiche</a>
        <a href="#" class="item" data-section="tables">ðŸª‘ Tavoli</a>
      </div>
      <div class="card">
        <label style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
          <input type="checkbox" id="chk-sound"/> Suono nuovi ordini
        </label>
        <label style="display:flex;gap:8px;align-items:center">
          <input type="checkbox" id="chk-autorefresh"/> Auto-aggiorna
        </label>
      </div>
    </aside>

    <!-- Main -->
    <main>
      <!-- ORDERS -->
      <section id="sec-orders" class="card">
        <div class="row" style="flex-wrap:wrap">
          <div class="kg">
            <span class="muted">Stato:</span>
            <button class="btn tab active" data-status="pending">Pendenti <span id="c-pend" class="pill" style="padding:2px 8px"></span></button>
            <button class="btn tab" data-status="completed">Completati <span id="c-comp" class="pill" style="padding:2px 8px"></span></button>
            <button class="btn tab" data-status="canceled">Eliminati <span id="c-canc" class="pill" style="padding:2px 8px"></span></button>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <input id="q" class="input" placeholder="Cerca tavolo o piattoâ€¦" />
            <span id="clearQ" class="clearx">Elimina</span>
            <button id="btn-refresh" class="btn brand">Aggiorna</button>
          </div>
        </div>
        <div id="orders"></div>
      </section>

      <!-- STATS -->
      <section id="sec-stats" class="card" style="display:none">
        <div class="grid2">
          <div class="card">
            <h3 style="margin:0 0 8px 0">Giorno</h3>
            <div class="row" style="gap:8px">
              <input id="day" type="date" class="input" />
              <button id="btn-day" class="btn brand">Aggiorna</button>
            </div>
            <div id="kpis" class="kg" style="margin-top:10px">
              <div class="k">Ordini: <b id="k-count">0</b></div>
              <div class="k">Incasso: <b id="k-rev">â‚¬ 0,00</b></div>
              <div class="k">Scontrino medio: <b id="k-avg">â‚¬ 0,00</b></div>
            </div>
            <div class="card" style="margin-top:12px">
              <canvas id="chartHour" height="160"></canvas>
            </div>
          </div>
          <div class="card">
            <h3 style="margin:0 0 8px 0">Intervallo</h3>
            <div class="row" style="gap:8px">
              <input id="from" type="date" class="input" />
              <input id="to"   type="date" class="input" />
              <button id="btn-range" class="btn brand">Aggiorna</button>
            </div>
            <div class="card" style="margin-top:12px">
              <canvas id="chartTop" height="160"></canvas>
            </div>
            <div class="tbl" id="topTable" style="margin-top:12px"></div>
          </div>
        </div>
      </section>